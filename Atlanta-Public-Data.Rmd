---
title: "Atlanta Public Data"
output:
  html_document:
    df_print: paged
---

# [Vendor Payments](https://data.fultoncountyga.gov/Tax-Finance/Vendor-Payments/mxhc-krcg)

This dataset consists of a listing of payments made to Fulton County vendors for poducts and services provided to the County. The payment records span the period from January 1, 2014 to present. Included with each payment record is the disbursement date, the department making the payment, the type of service or product, the fund from which the payment is drawn, the payment amount and the name of the vendor to which the payment was made. This dataset is updated weekly.

```{r}
## Install the required package with:
## install.packages("RSocrata")
library("dplyr")
library("RSocrata")
library("tidyverse")

VendorPayments <- read.socrata(
  "https://data.fultoncountyga.gov/resource/mxhc-krcg.json"
)
```

```{r}
VendorPayments
```


```{r}
VendorPayments <-
        VendorPayments %>% mutate(payment_type = as.factor(payment_type),
                                  city = as.factor(city),
                                  fiscal_year = as.numeric(fiscal_year),
                                  fy_period = as.numeric(fy_period),
                                  dept = as.factor(dept),
                                  unit = as.factor(unit),
                                  unit_name = as.factor(unit_name),
                                  object = as.factor(object),
                                  object_name = as.factor(object_name),
                                  fund = as.factor(fund),
                                  fund_name = as.factor(fund_name),
                                  amount = as.numeric(amount),
                                  # = as.numeric(),
                                  # = as.numeric(),
                                  # = as.numeric(),
                                  vendor_legal_name  = as.factor(vendor_legal_name),
                                  check_status  = as.factor(check_status),
                                  #  = as.factor(),
                                  #  = as.factor(),
                                  #  = as.factor(),
                                  department_name = as.factor(department_name)) %>%
        select(-c("vendor_code", "check_no","dis_doc_id", "payment_document", "vendor_invoice_no", "dept", "unit", "fiscal_year", "fy_period", "object", "fund", "vendor_invoice_date", "payment_type", "disb_week", "vendor_invoice_week", "check_clearance_or_cancel_date", "check_cc_week",	"city"
))
summary(VendorPayments, maxsum = 8)
```






```{r}
#googledrive::drive_auth()
library(openxlsx)
library(googledrive)
openxlsx::write.xlsx(list("Vendor Payments" = VendorPayments) , "Atlanta.xlsx", overwrite = TRUE, asTable = TRUE, freezePane = c("firstRow"), colWidths = "auto", withFilter = TRUE)
#googledrive::drive_upload(media ="Atlanta.xlsx",   type = "spreadsheet", overwrite = TRUE)
googledrive::drive_update(media ="Atlanta.xlsx", file = as_id("1yVUKyYIfw6-2f6HfHImNtVORrBTnuIuCpZRDrNCYaI8"))
```



